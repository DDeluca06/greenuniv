<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Greensfield University - <%= course.CourseName %></title>
    <link rel="stylesheet" type="text/css" href="/css/dashboard.css" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>  
  <% if (user && user.isFacilitator) { %>
    <button hx-get="/api/edit-course-form/<%= course.CourseID %>"
        hx-target="#edit-course-modal-content"
        hx-swap="innerHTML"
        hx-on::after-request="openEditModal()"
        class="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600">
   Edit Course
</button>
  <% } %>  
<h3 class="text-lg font-semibold"><%= course.CourseName %></h3>
<p class="text-gray-600"><%= course.CourseDesc %></p>
<p class="text-gray-600">Enrollment: <%= course?.Credits ?? 'N/A' %> Credit<% if (course.Credits > 1) { %>s<% } %></p>
<p class="text-gray-600">Course ID: <%= course.CourseID %></p>
<% if (typeof enrolledStudents !== 'undefined' && enrolledStudents.length > 0) { %>
  <h3 class="text-lg font-semibold mt-4">Enrolled Students:</h3>
  <ul class="list-disc pl-4">
    <% enrolledStudents.forEach(student => { %>
      <li><%= student.StudentName %></li>
    <% }); %>
  </ul>
  <a href="/dashboard" 
     class="mt-4 inline-block bg-gray-500 text-white px-3 py-2 rounded hover:bg-gray-600">
     ‚Üê Back to Courses
  </a>       
<% } else if (course) { %>
  <p>No students enrolled in this course.</p>
<% } else { %>
  <p>No course found.</p>
<% } %>

<!-- Modal Container -->
<div id="edit-course-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div id="edit-course-modal-content" class="bg-white p-6 rounded-lg shadow-lg">
        <!-- HTMX will load the edit form here -->
    </div>
</div>

<script>
    document.addEventListener("htmx:afterSwap", function(event) {
        if (event.detail.target.id === "edit-course-modal-content") {
            document.getElementById("edit-course-modal").classList.remove("hidden");
        }
    });
    
    function openEditModal() {
        document.getElementById("edit-course-modal").classList.remove("hidden");
    }
</script>